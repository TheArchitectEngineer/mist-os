# Label applied to temporary files used in this test.
type test_ioctl_file_t;
typeattribute test_ioctl_file_t file_like_a;
#allow test_ioctl_file_t unconfined_t:filesystem { associate };
allow test_ioctl_file_t tmpfs_t:filesystem { associate };
allow tmpfs_t self:filesystem { associate };

# Domain used to validate that FIGETBSZ access is granted via "getattr".
type test_ioctl_figetbsz_allowed_t;
typeattribute test_ioctl_figetbsz_allowed_t test_a;
allow test_ioctl_figetbsz_allowed_t test_ioctl_file_t:file { getattr };

# Domain used to validate that FIGETBSZ access is denied if "getattr".
type test_ioctl_figetbsz_denied_t;
typeattribute test_ioctl_figetbsz_denied_t test_a;
neverallow test_ioctl_figetbsz_denied_t test_ioctl_file_t:file { getattr };
